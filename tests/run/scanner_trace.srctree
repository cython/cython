PYTHON setup.py build_ext --inplace

######## setup.py ###########

from distutils.core import setup
from Cython.Build import cythonize

import Cython.Compiler.Scanning

Cython.Compiler.Scanning.trace_scanner = 1

setup(ext_modules=cythonize("*.pyx"))

from importlib.util import spec_from_file_location, module_from_spec
import glob
ext_files = glob.glob("simple*.so") + glob.glob("simple*.pyd")
assert ext_files
spec = spec_from_file_location('simple', ext_files[0])
simple = module_from_spec(spec)
spec.loader.exec_module(simple)


assert simple.test() == 123


######## simple.pyx ###########

def test():
    return 123
